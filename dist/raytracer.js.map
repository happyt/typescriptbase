{"version":3,"sources":["webpack:///webpack/bootstrap cef5a12bc74b4d4cfd1b","webpack:///./src/raytracer.ts"],"names":[],"mappings":"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","file":"./dist/raytracer.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap cef5a12bc74b4d4cfd1b\n **/","class Vector {\r\n    constructor(public x: number,\r\n                public y: number,\r\n                public z: number) {\r\n    }\r\n    static times(k: number, v: Vector) { return new Vector(k * v.x, k * v.y, k * v.z); }\r\n    static minus(v1: Vector, v2: Vector) { return new Vector(v1.x - v2.x, v1.y - v2.y, v1.z - v2.z); }\r\n    static plus(v1: Vector, v2: Vector) { return new Vector(v1.x + v2.x, v1.y + v2.y, v1.z + v2.z); }\r\n    static dot(v1: Vector, v2: Vector) { return v1.x * v2.x + v1.y * v2.y + v1.z * v2.z; }\r\n    static mag(v: Vector) { return Math.sqrt(v.x * v.x + v.y * v.y + v.z * v.z); }\r\n    static norm(v: Vector) {\r\n        var mag = Vector.mag(v);\r\n        var div = (mag === 0) ? Infinity : 1.0 / mag;\r\n        return Vector.times(div, v);\r\n    }\r\n    static cross(v1: Vector, v2: Vector) {\r\n        return new Vector(v1.y * v2.z - v1.z * v2.y,\r\n                          v1.z * v2.x - v1.x * v2.z,\r\n                          v1.x * v2.y - v1.y * v2.x);\r\n    }\r\n}\r\n\r\nclass Color {\r\n    constructor(public r: number,\r\n                public g: number,\r\n                public b: number) {\r\n    }\r\n    static scale(k: number, v: Color) { return new Color(k * v.r, k * v.g, k * v.b); }\r\n    static plus(v1: Color, v2: Color) { return new Color(v1.r + v2.r, v1.g + v2.g, v1.b + v2.b); }\r\n    static times(v1: Color, v2: Color) { return new Color(v1.r * v2.r, v1.g * v2.g, v1.b * v2.b); }\r\n    static white = new Color(1.0, 1.0, 1.0);\r\n    static grey = new Color(0.5, 0.5, 0.5);\r\n    static black = new Color(0.0, 0.0, 0.0);\r\n    static background = Color.black;\r\n    static defaultColor = Color.black;\r\n    static toDrawingColor(c: Color) {\r\n        var legalize = d => d > 1 ? 1 : d;\r\n        return {\r\n            r: Math.floor(legalize(c.r) * 255),\r\n            g: Math.floor(legalize(c.g) * 255),\r\n            b: Math.floor(legalize(c.b) * 255)\r\n        }\r\n    }\r\n}\r\n\r\nclass Camera {\r\n    public forward: Vector;\r\n    public right: Vector;\r\n    public up: Vector;\r\n\r\n    constructor(public pos: Vector, lookAt: Vector) {\r\n        var down = new Vector(0.0, -1.0, 0.0);\r\n        this.forward = Vector.norm(Vector.minus(lookAt, this.pos));\r\n        this.right = Vector.times(1.5, Vector.norm(Vector.cross(this.forward, down)));\r\n        this.up = Vector.times(1.5, Vector.norm(Vector.cross(this.forward, this.right)));\r\n    }\r\n}\r\n\r\ninterface Ray {\r\n    start: Vector;\r\n    dir: Vector;\r\n}\r\n\r\ninterface Intersection {\r\n    thing: Thing;\r\n    ray: Ray;\r\n    dist: number;\r\n}\r\n\r\ninterface Surface {\r\n    diffuse: (pos: Vector) => Color;\r\n    specular: (pos: Vector) => Color;\r\n    reflect: (pos: Vector) => number;\r\n    roughness: number;\r\n}\r\n\r\ninterface Thing {\r\n    intersect: (ray: Ray) => Intersection;\r\n    normal: (pos: Vector) => Vector;\r\n    surface: Surface;\r\n}\r\n\r\ninterface Light {\r\n    pos: Vector;\r\n    color: Color;\r\n}\r\n\r\ninterface Scene {\r\n    things: Thing[];\r\n    lights: Light[];\r\n    camera: Camera;\r\n}\r\n\r\nclass Sphere implements Thing {\r\n    public radius2: number;\r\n\r\n    constructor(public center: Vector, radius: number, public surface: Surface) {\r\n        this.radius2 = radius * radius;\r\n    }\r\n    normal(pos: Vector): Vector { return Vector.norm(Vector.minus(pos, this.center)); }\r\n    intersect(ray: Ray) {\r\n        var eo = Vector.minus(this.center, ray.start);\r\n        var v = Vector.dot(eo, ray.dir);\r\n        var dist = 0;\r\n        if (v >= 0) {\r\n            var disc = this.radius2 - (Vector.dot(eo, eo) - v * v);\r\n            if (disc >= 0) {\r\n                dist = v - Math.sqrt(disc);\r\n            }\r\n        }\r\n        if (dist === 0) {\r\n            return null;\r\n        } else {\r\n            return { thing: this, ray: ray, dist: dist };\r\n        }\r\n    }\r\n}\r\n\r\nclass Plane implements Thing {\r\n    public normal: (pos: Vector) =>Vector;\r\n    public intersect: (ray: Ray) =>Intersection;\r\n    constructor(norm: Vector, offset: number, public surface: Surface) {\r\n        this.normal = function(pos: Vector) { return norm; }\r\n        this.intersect = function(ray: Ray): Intersection {\r\n            var denom = Vector.dot(norm, ray.dir);\r\n            if (denom > 0) {\r\n                return null;\r\n            } else {\r\n                var dist = (Vector.dot(norm, ray.start) + offset) / (-denom);\r\n                return { thing: this, ray: ray, dist: dist };\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nmodule Surfaces {\r\n    export var shiny: Surface = {\r\n        diffuse: function(pos) { return Color.white; },\r\n        specular: function(pos) { return Color.grey; },\r\n        reflect: function(pos) { return 0.7; },\r\n        roughness: 250\r\n    }\r\n    export var checkerboard: Surface = {\r\n        diffuse: function(pos) {\r\n            if ((Math.floor(pos.z) + Math.floor(pos.x)) % 2 !== 0) {\r\n                return Color.white;\r\n            } else {\r\n                return Color.black;\r\n            }\r\n        },\r\n        specular: function(pos) { return Color.white; },\r\n        reflect: function(pos) {\r\n            if ((Math.floor(pos.z) + Math.floor(pos.x)) % 2 !== 0) {\r\n                return 0.1;\r\n            } else {\r\n                return 0.7;\r\n            }\r\n        },\r\n        roughness: 150\r\n    }\r\n}\r\n\r\n\r\nclass RayTracer {\r\n    private maxDepth = 5;\r\n\r\n    private intersections(ray: Ray, scene: Scene) {\r\n        var closest = +Infinity;\r\n        var closestInter: Intersection = undefined;\r\n        for (var i in scene.things) {\r\n            var inter = scene.things[i].intersect(ray);\r\n            if (inter != null && inter.dist < closest) {\r\n                closestInter = inter;\r\n                closest = inter.dist;\r\n            }\r\n        }\r\n        return closestInter;\r\n    }\r\n\r\n    private testRay(ray: Ray, scene: Scene) {\r\n        var isect = this.intersections(ray, scene);\r\n        if (isect != null) {\r\n            return isect.dist;\r\n        } else {\r\n            return undefined;\r\n        }\r\n    }\r\n\r\n    private traceRay(ray: Ray, scene: Scene, depth: number): Color {\r\n        var isect = this.intersections(ray, scene);\r\n        if (isect === undefined) {\r\n            return Color.background;\r\n        } else {\r\n            return this.shade(isect, scene, depth);\r\n        }\r\n    }\r\n\r\n    private shade(isect: Intersection, scene: Scene, depth: number) {\r\n        var d = isect.ray.dir;\r\n        var pos = Vector.plus(Vector.times(isect.dist, d), isect.ray.start);\r\n        var normal = isect.thing.normal(pos);\r\n        var reflectDir = Vector.minus(d, Vector.times(2, Vector.times(Vector.dot(normal, d), normal)));\r\n        var naturalColor = Color.plus(Color.background,\r\n                                      this.getNaturalColor(isect.thing, pos, normal, reflectDir, scene));\r\n        var reflectedColor = (depth >= this.maxDepth) ? Color.grey : this.getReflectionColor(isect.thing, pos, normal, reflectDir, scene, depth);\r\n        return Color.plus(naturalColor, reflectedColor);\r\n    }\r\n\r\n    private getReflectionColor(thing: Thing, pos: Vector, normal: Vector, rd: Vector, scene: Scene, depth: number) {\r\n        return Color.scale(thing.surface.reflect(pos), this.traceRay({ start: pos, dir: rd }, scene, depth + 1));\r\n    }\r\n\r\n    private getNaturalColor(thing: Thing, pos: Vector, norm: Vector, rd: Vector, scene: Scene) {\r\n        var addLight = (col, light) => {\r\n            var ldis = Vector.minus(light.pos, pos);\r\n            var livec = Vector.norm(ldis);\r\n            var neatIsect = this.testRay({ start: pos, dir: livec }, scene);\r\n            var isInShadow = (neatIsect === undefined) ? false : (neatIsect <= Vector.mag(ldis));\r\n            if (isInShadow) {\r\n                return col;\r\n            } else {\r\n                var illum = Vector.dot(livec, norm);\r\n                var lcolor = (illum > 0) ? Color.scale(illum, light.color)\r\n                                          : Color.defaultColor;\r\n                var specular = Vector.dot(livec, Vector.norm(rd));\r\n                var scolor = (specular > 0) ? Color.scale(Math.pow(specular, thing.surface.roughness), light.color)\r\n                                          : Color.defaultColor;\r\n                return Color.plus(col, Color.plus(Color.times(thing.surface.diffuse(pos), lcolor),\r\n                                                  Color.times(thing.surface.specular(pos), scolor)));\r\n            }\r\n        }\r\n        return scene.lights.reduce(addLight, Color.defaultColor);\r\n    }\r\n\r\n    render(scene, ctx, screenWidth, screenHeight) {\r\n        var getPoint = (x, y, camera) => {\r\n            var recenterX = x =>(x - (screenWidth / 2.0)) / 2.0 / screenWidth;\r\n            var recenterY = y => - (y - (screenHeight / 2.0)) / 2.0 / screenHeight;\r\n            return Vector.norm(Vector.plus(camera.forward, Vector.plus(Vector.times(recenterX(x), camera.right), Vector.times(recenterY(y), camera.up))));\r\n        }\r\n        for (var y = 0; y < screenHeight; y++) {\r\n            for (var x = 0; x < screenWidth; x++) {\r\n                var color = this.traceRay({ start: scene.camera.pos, dir: getPoint(x, y, scene.camera) }, scene, 0);\r\n                var c = Color.toDrawingColor(color);\r\n                ctx.fillStyle = \"rgb(\" + String(c.r) + \", \" + String(c.g) + \", \" + String(c.b) + \")\";\r\n                ctx.fillRect(x, y, x + 1, y + 1);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\nfunction defaultScene(): Scene {\r\n    return {\r\n        things: [new Plane(new Vector(0.0, 1.0, 0.0), 0.0, Surfaces.checkerboard),\r\n                 new Cube(new Vector(-3.5, 2.5, -1.25), 1.0, Surfaces.checkerboard),\r\n                 new Sphere(new Vector(-3.5, 1.0, -1.25), 1.0, Surfaces.shiny),\r\n                 new Sphere(new Vector(0.0, 1.0, -0.25), 1.0, Surfaces.shiny),\r\n                 new Sphere(new Vector(-1.0, 0.5, 1.5), 0.5, Surfaces.shiny)],\r\n        lights: [{ pos: new Vector(-2.0, 2.5, 0.0), color: new Color(0.49, 0.07, 0.07) },\r\n                 { pos: new Vector(1.5, 2.5, 1.5), color: new Color(0.07, 0.07, 0.49) },\r\n                 { pos: new Vector(1.5, 2.5, -1.5), color: new Color(0.07, 0.49, 0.071) },\r\n                 { pos: new Vector(0.0, 3.5, 0.0), color: new Color(0.21, 0.21, 0.35) }],\r\n        camera: new Camera(new Vector(3.0, 2.0, 4.0), new Vector(-1.0, 0.5, 0.0))\r\n    };\r\n}\r\n\r\nfunction exec() {\r\n    var canv = document.createElement(\"canvas\");\r\n    canv.width = 512;\r\n    canv.height = 512;\r\n    document.body.appendChild(canv);\r\n    var ctx = canv.getContext(\"2d\");\r\n    var rayTracer = new RayTracer();\r\n    return rayTracer.render(defaultScene(), ctx, canv.width, canv.height);\r\n}\r\n\r\nexec();\n\n\n/** WEBPACK FOOTER **\n ** ./src/raytracer.ts\n **/"],"sourceRoot":""}